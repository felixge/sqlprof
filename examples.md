# Examples

## Filter CPU Time by Function Name

Note: Not implemented yet.

```sql
SELECT *
FROM cpu_time
WHERE list_contains(functions, 'runtime.mallocgc');
```

# Filter CPU Time by Span ID

```sql
SELECT cpu_ms, location_ids
FROM pprof.cpu_time
WHERE labels['span id'][1] = '1858882002096831339';
```

```
┌────────┬─────────────────────────────────────────────────────────────────────────────────┐
│ cpu_ms │                                  location_ids                                   │
│ double │                                    uint64[]                                     │
├────────┼─────────────────────────────────────────────────────────────────────────────────┤
│   10.0 │ [795, 801, 679, 680, 85, 681, 682, 337, 744, 171]                               │
│   10.0 │ [1925, 3908, 5474, 6630, 7955, 1631, 1632, 166, 167, 3087, 3088, 232, 233, 171] │
│   10.0 │ [8016, 4647, 8017, 1634, 1635, 231, 232, 233, 171]                              │
│   10.0 │ [66, 67, 68, 261, 262, 263, 1856, 255, 1857, 1858, 171]                         │
│   10.0 │ [2394, 2395, 2396, 227, 228, 229, 230, 231, 232, 233, 171]                      │
│   10.0 │ [3092, 1929, 171]                                                               │
│   10.0 │ [798, 679, 680, 85, 681, 682, 337, 2005, 2006, 233, 171]                        │
│   10.0 │ [4731, 2886, 85, 2887, 733, 1026, 171]                                          │
│   10.0 │ [8140, 357, 59, 2598, 2599, 2600, 2589, 2590, 2591]                             │
│   10.0 │ [8323, 232, 233, 171]                                                           │
│   10.0 │ [473, 157, 337, 3742, 3880, 2006, 233, 171]                                     │
│   10.0 │ [5391, 4571, 1634, 1635, 231, 232, 233, 171]                                    │
│   10.0 │ [6956, 166, 167, 4571, 1634, 1635, 231, 232, 233, 171]                          │
│   10.0 │ [2040, 252, 1183, 171]                                                          │
│   10.0 │ [798, 679, 680, 85, 681, 682, 337, 778, 779, 171]                               │
│   10.0 │ [2011, 2823, 1929, 171]                                                         │
│   10.0 │ [2439, 171]                                                                     │
│   10.0 │ [1105, 737, 679, 680, 85, 681, 682, 337, 778, 779, 171]                         │
│   20.0 │ [66, 67, 68, 69, 70, 71, 2264, 2265, 232, 233, 171]                             │
│   10.0 │ [1925, 2441, 733, 2442, 171]                                                    │
│   10.0 │ [7684, 1929, 171]                                                               │
│   10.0 │ [1720, 460, 461, 462, 85, 249, 250, 251, 7202, 7203, 171]                       │
├────────┴─────────────────────────────────────────────────────────────────────────────────┤
│ 22 rows                                                                        2 columns │
└──────────────────────────────────────────────────────────────────────────────────────────┘
```

## Top 10 Spans by CPU Time.

```sql
SELECT
    coalesce(labels['span id'][1], 'n/a') AS span_id,
    sum(cpu_ms)
FROM pprof.cpu_time
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```

```
┌─────────────────────┬─────────────┐
│       span_id       │ sum(cpu_ms) │
│       varchar       │   double    │
├─────────────────────┼─────────────┤
│ n/a                 │     68380.0 │
│ 1960784553651774040 │      7100.0 │
│ 1108252810609145853 │      3100.0 │
│ 4935374964964654112 │      1760.0 │
│ 6965679889071869774 │      1040.0 │
│ 2380311954168219905 │       770.0 │
│ 6209069098809614443 │       590.0 │
│ 8156515739543522831 │       420.0 │
│ 8232626902656514899 │       250.0 │
│ 1858882002096831339 │       230.0 │
├─────────────────────┴─────────────┤
│ 10 rows                 2 columns │
└───────────────────────────────────┘
```