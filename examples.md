# Examples

## Filter CPU Time by Function Name

Note: Not implemented yet.

```sql
SELECT *
FROM cpu_time
WHERE list_contains(functions, 'runtime.mallocgc');
```

# Filter CPU Time by Span ID

```sql
SELECT cpu_ms, location_ids
FROM pprof.cpu_time
WHERE labels['local root span id'][1] = '445324626760191976';
```

```
┌────────┬────────────────────────────────────────────────────────────────────────────────────────────┐
│ cpu_ms │                                        location_ids                                        │
│ double │                                          uint64[]                                          │
├────────┼────────────────────────────────────────────────────────────────────────────────────────────┤
│   10.0 │ [202, 52, 27, 12, 13, 3, 4, 5, 6, 7]                                                       │
│   10.0 │ [221, 127, 26, 27, 12, 13, 3, 4, 5, 6, 7]                                                  │
│   10.0 │ [345, 11, 12, 13, 3, 4, 5, 6, 7]                                                           │
│   10.0 │ [389, 390, 391, 392, 393, 141, 3, 4, 5, 6, 7]                                              │
│   10.0 │ [235, 292, 293, 294, 295, 296, 297, 298, 78, 79, 80, 4, 5, 6, 7]                           │
│   10.0 │ [270, 271, 27, 12, 13, 3, 4, 5, 6, 7]                                                      │
│   10.0 │ [126, 127, 26, 27, 12, 13, 3, 4, 5, 6, 7]                                                  │
│   10.0 │ [325, 11, 12, 13, 3, 4, 5, 6, 7]                                                           │
│   10.0 │ [1396, 1090, 2, 3, 4, 5, 6, 7]                                                             │
│   10.0 │ [172, 104, 11, 12, 13, 3, 4, 5, 6, 7]                                                      │
│   10.0 │ [25, 26, 27, 12, 13, 3, 4, 5, 6, 7]                                                        │
│   10.0 │ [235, 292, 293, 294, 295, 296, 297, 298, 78, 79, 80, 4, 5, 6, 7]                           │
│   10.0 │ [50, 51, 52, 27, 12, 13, 3, 4, 5, 6, 7]                                                    │
│   10.0 │ [286, 26, 27, 12, 13, 3, 4, 5, 6, 7]                                                       │
│   10.0 │ [1643, 152, 153, 154, 155, 78, 79, 80, 4, 5, 6, 7]                                         │
│   10.0 │ [186, 52, 27, 12, 13, 3, 4, 5, 6, 7]                                                       │
│   10.0 │ [172, 10, 11, 12, 13, 3, 4, 5, 6, 7]                                                       │
│   10.0 │ [860, 157, 158, 159, 160, 161, 133, 134, 135, 136, 137, 138, 139, 140, 141, 3, 4, 5, 6, 7] │
│   10.0 │ [9, 10, 11, 12, 13, 3, 4, 5, 6, 7]                                                         │
│   20.0 │ [103, 104, 11, 12, 13, 3, 4, 5, 6, 7]                                                      │
│   10.0 │ [792, 583, 743, 2, 3, 4, 5, 6, 7]                                                          │
├────────┴────────────────────────────────────────────────────────────────────────────────────────────┤
│ 21 rows                                                                                   2 columns │
└─────────────────────────────────────────────────────────────────────────────────────────────────────┘
```

## Top 10 Spans by CPU Time.

```sql
SELECT
    coalesce(labels['span id'][1], 'n/a') AS span_id,
    sum(cpu_ms)
FROM pprof.cpu_time
GROUP BY 1
ORDER BY 2 DESC
LIMIT 10;
```

```
┌─────────────────────┬─────────────┐
│       span_id       │ sum(cpu_ms) │
│       varchar       │   double    │
├─────────────────────┼─────────────┤
│ n/a                 │     68380.0 │
│ 1960784553651774040 │      7100.0 │
│ 1108252810609145853 │      3100.0 │
│ 4935374964964654112 │      1760.0 │
│ 6965679889071869774 │      1040.0 │
│ 2380311954168219905 │       770.0 │
│ 6209069098809614443 │       590.0 │
│ 8156515739543522831 │       420.0 │
│ 8232626902656514899 │       250.0 │
│ 1858882002096831339 │       230.0 │
├─────────────────────┴─────────────┤
│ 10 rows                 2 columns │
└───────────────────────────────────┘
```